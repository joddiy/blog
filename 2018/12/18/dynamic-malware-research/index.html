
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Jz Blog">
    <title>Dynamic Malware Detection Research - Jz Blog</title>
    <meta name="author" content="Joddiy Zhang">
    
    
        <link rel="icon" href="http://joddiy.cc/assets/images/favicon.ico">
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Joddiy Zhang","sameAs":["https://github.com/joddiy","https://scholar.google.com/citations?user=KH-xv38AAAAJ&hl=en&oi=sra","https://www.linkedin.com/in/joddiyzhang/"],"image":"14108933.jpeg"},"articleBody":"Using Spatio-Temporal Information in API Calls with Machine Learning Algorithms for Malware Detection（2009）This paper uses statistical features which are extracted from both spatial (arguments) and temporal (sequences) information available in Windows API calls. \nThe Windows API provides thousands of distinct API calls serving diverse functionalities. However, this paper chooses short-listed 237 API calls which are widely used by both benign Windows applications and malware programs. They refer to the short-listed calls as the core-functionality API calls. They further divide the core-functionality API calls into seven different categories: (1) registry, (2) network management, (3) memory management, (4) file I&#x2F;O, (5) socket, (6) processor and threads, and (7) dynamically linked libraries (DLLs). \n\nspatial informationThe spatial information refers to the set of arguments which always are generally address pointers or variables that hold crisp numerical values. They use fundamental statistical and information theoretic measures to quantify the spatial information. These measures include mean, variance, entropy, minimum, and maximum of given values. For example, they have observed that malware writers suffice on lean and mean implementations of malware programs with low memory usage so that they can remain unnoticed for as long as possible.\nTemporal informationTemporal information refers to represents the order of invoked API calls where call sequences and control flow graphs are the most popular techniques. By some auto-correlation analysis, this paper finds that 3rd order dependence has a high correlation for both benign and malware programs, so it finally uses 3-gram API call sequence. Then they model API call sequence using a discrete time Markov chain. The order of a Markov chain represents the extent to which past states determine the present state. They uses 3rd order Markov chain to represent the probability of transitions, which means the next possible API call depends on previous three API calls. The transition matrix T looks like:\n\nEach element in this matrix indicates the probability of a new API call when they have observed the first 3 API calls. Then the paper information gain to select the most discriminative features:\n\nSpecifically, for each element in the matrix, the paper uses a to count its appearance times in benign training samples and b to count in malware samples. Then this element’s information gain can be computed by:\n\nExperimentThe paper designs an experiment using spatio-temporal features’ set over standalone spatial or temporal features set.  \n\nThe table shows that that spatial and temporal features alone can provide on the average detection accuracies of approximately 0.898 and 0.952 respectively. However, the combined spatio-temporal features’ set provide an average detection accuracy of 0.963 – approximately 5% improvement over standalone features’ set.\nNB with spatio-temporal features’ set provides the best detection accuracy of 0.980. It is closely followed by SMO which provides the detection accuracy of 0.968. On the other hand, J48 provides the lowest accuracy of 0.947.\nDiscovering Similar Malware Samples Using API Call Topics（2015）This paper aims to extract similar malware samples automatically using the concept of “API call topics,” which represents a set of API calls that are intrinsic to a specific group of malware samples. They present an unsupervised approach to extract API call topics from a large corpus of API calls. Through analysis of the API call logs collected from thousands of malware samples, they demonstrate that the extracted API call topics can detect similar malware samples. The proposed approach is expected to be useful for automating the process of analyzing a huge volume of logs collected from dynamic malware analysis systems.\nThe key idea of this paper is that they present an unsupervised approach to extract API call topics which can detect similar malware samples. \nDatasetThe data of this paper consists of Cuckoo Sandbox logs of 2,641 malware samples collected from September 2012 to March 2013. The format of all malware samples was the Portable Executable (PE) format used in Windows operating systems. These malware samples were executed on Cuckoo Sandbox in 90 seconds and generated 1.7 GB of dynamic analysis logs in JSON format.\nSome interesting they found:\n\nThe majority of the samples had more than 400 API calls, a few samples had only a small number of API calls.\nMalware samples that exhibited a very low number of API calls likely failed to execute correctly because of the anti-VM techniques. Therefore, they pruned malware samples with fewer than 10 API calls.\n\nMethodologiesAPI words featuresThis paper parsed the JSON formatted Cuckoo Sandbox log, then they used three variables(API function names, arguments names, argument values) to convert an API call into an “API word”， and they omitted return values and thread IDs.\nThey used level-3 approach to compress the API logs. Its definition is api:n1:v1:n2:v2:…, for example, “LdrGetDllHandle”:”FileName”:”C:nnWINDOWSnnsystem32nnrpcss.dll”:”ModuleHandle”:0x00000000. Using the API words, they generated a feature vector for each malware sample (By BoW approach with TF-IDF word weighting). \nFeature selectionThe paper applied DF-thresholding to eliminate very popular API words that appear in a majority of the malware samples. These API words are too generic to characterize a cluster of malware samples. \nNon-negative Matrix Factorization (NMF)NMF is an algorithm that factorizes a matrix into two matrices with the constraint that all three matrices have no negative elements. The advantage of NMF is that it can extract topics that can then be used as signatures for the task. \nThe key idea of NMF is to factorize the feature matrix X, i.e., X &#x3D; TV.\n\nK is a parameter that controls the number of basis, which corresponds to clusters. The matrices T and V can be interpreted as the topic (basis) and the clustering results, respectively. This factorization can be obtained by minimizing the distance between the matrices X and TV: \n\nThe paper adopt Kullback-Leibler(KL) divergence to compute the distance d:\n\nResultThe API call topics successfully extracted malware samples that had the similar intrinsic API calls. In addition, the detected malware samples were actually similar to each other because the majority of the detected samples have a single primary label in each cluster.\n\nDeepSign: Deep Learning for Automatic Malware Signature Generation and Classification（2015）The method uses a deep belief network (DBN), implemented with a deep stack of denoising autoencoders, generating an invariant compact representation of the malware behavior.\nFeatureThis paper used one of the simplest method of NLP to approach the sandbox files, that is, using unigram(1-gram) extraction. Furthermore, this paper in order to remain as domain agnostic as possible, they propose to treat the sandbox file as a simple text file, and extract unigrams without any preprocessing. That means, they omits all meaningless symbols and only pay attention to the words, for example, given “api”: “CreateFileW”, the terms extracted are “api”: and “CreateFileW”, completely ignoring what each part means. \nIn order to get the fixed size features, they proposed that:\n\nFor each sandbox file in the dataset, extract all unigrams.\nRemove the unigrams which appear in all files (contain no information).\nFor each unigram count the number of files in which it appears.\nSelect top 20,000 with highest frequency.\nConvert each sandbox file to a 20,000 sized bit string, by checking whether each of the 20,000 unigrams appeared in it.\n\nIn their approach, they trained a deep denoising autoencoder consisting of eight layer: 20,000–5,000–2,500–1,000–500–250–100–30. At each step only one layer is trained, then the weights are “frozen”, and the subsequent layer is trained. \nAt the end of this training phase, they have a deep network which is capable of converting the 20,000 input vector into 30 floating point values. They regard these 30-sized vector as the “signature” of the program.\nThe process of DBN training looks like:\n\n(I) Train the first autoencoder layer. (II) Use the weights from the previous layer, and build a new autoencoder on top of them. The weights taken from the first autoencoder are frozen. (III) Similarly, take the weights from the previous layer and add a new layer. (IV) Proceed with layer-wise training until training all the eight layers for the final DBN.\nThe all steps of this paper:\n\nSome configuration:\n\nEach layer-wise training with a 0.5 dropout.\nUsing ReLU as the activation function.\n0.2 noise ratio, 0.001 learning rate then linearly decays to 0.000001, batch size of 20, and no momentum.\n\nDatasetTheir dataset consists of six major categories of malware, and 300 variants in each category, for a total of 1,800 samples. The six malware categories used are Zeus, Carberp, Spy-Eye, Cidox, Andromeda, and DarkComet.\nExperimental Results\nSVM with 96.4% accuracy.\nKNN with 95.3% accuracy.\nThis paper’s DBN with 98.6% accuracy.\n\nA Novel Approach to Detect Malware Based on API Call Sequence Analysis（2015)This paper adopted DNA sequence alignment algorithms and extracted common API call sequence patterns of malicious function from malware in different categories. They indicated that two major approaches in dynamic analysis are control flow analysis and API call analysis. However, malware authors try to circumvent those techniques through inserting meaningless codes or shuffling the sequence of programs.\nDNA Sequence AlignmentSequence alignment algorithms are most widely used in the area of biometrics to calculate the similarity between two or more DNA sequences or to find certain DNA subsequences from full DNA.\nSequence alignment algorithms fall into two categories, which are global and local alignment. Global alignment aligns entire sequence. It is useful when they attempt to find the sequence of most similar length and strings. Local alignment finds the highly similar subsequences between given sequences. \nPairwise sequence alignment methods find global alignments or the locally similar subsequences of two sequences. Multiple sequence alignment algorithm extends pairwise alignment to handle multiple sequences at the same time. This paper applied multiple sequence alignment algorithm.\nEnvironment SetupIn this study, they used the Detours hooking library supported byMicrosoft to trace API call sequences from Windows executable programs. The Detours hooking process proceeds as shown in the following. Unlike the original process without Detours, the hooking process goes through the Detour function and the Trampoline function. This allows them to trace API call sequence.\n\nFor DNA sequence alignment, they used the ClustalX. ClustalX is widely used freeware in genome sequence analysis, such as DNA, RNA, or protein sequences. The program supports multiple sequence alignment (MSA) and also provides visualization.\nIn their dataset, 2,727 kinds of API were found; they categorized them into 26 groups according to MSDN library:In our dataset, 2,727 kinds of API were found; they categorized them into 26 groups according to MSDN library:\n\nTo extract the common API call sequence pattern among malware, the longest common subsequences (LCSs) were used. LCS shows the longest malware API call sequence pattern, it can be treated as a malware’s signature. For example, the LCSs of ABCD and ACB are AB and AC:\nFurthermore, they excluded these typical LCSs reduce false positive error since some benign programs share same API calls sequence. They employed an additional feature. They assumed that there exists a specific API call sequence pattern that matches specific malicious activity. If such an API call sequence pattern exists, they can detect unknown attacks by checking whether a critical API call sequence pattern exists. For example:\n\nIt should be noted that round brackets represent the OR relation. For example, in the case of IAT hooking, one possible critical API call sequence pattern is [LoadLibrary, strcmp, VirtualProtect]. They believe that this behavior-based malware classification can be effective in the dynamic analysis of API call sequences.\nThe overall process as following:\n\nIn the analysis process, the extracted API call sequence of a newly inserted program is compared with the API signatures in the database. If any LCS ismatched with the signatures, the newly inserted program is classified as malware.\nExperiment resultTo summarize, the precision is 1, FPR is 0, and recall is 0.998. The 𝐹1 score is 0.999.\n\nMALWARE CLASSIFICATION WITH RECURRENT NETWORKS(2015)This paper proposed a different approach, which, similar to natural language modeling, learns the language of malware spoken through the executed instructions and extracts robust, time domain features. Echo state networks (ESNs) and recurrent neural networks (RNNs) are used for the projection stage that extracts the features.\nSpecifically, using the recurrent model to directly classify the files is not efficient (there is only a single bit of information for every sequence). Instead, they use a recurrent model trained to predict next API call, and use the hidden state of the model (that encodes the history of past events) as the fixed-length feature vector that is given to a separate classifier (logistic regression or MLP).\nThe overall process as following:\n\nut and ht demote the input and state vectors. At each state, they apply a recurrent neural network operation to the input and get a hidden vector ht. Then they apply a max-pooling to get a feature vector, then, applying a MLP or logistic regression to do the classification on the feature vector\nFinally, they got TPR 71.71% at FPR 0.1%.\nMalware Characterization using Windows API Call Sequences(2016)This paper proposed a hashed method to identify the category of malware. First, they chose a total set of 534 important Win-APIs have been hooked and mapped to 26categories (A…Z). Then they used Fuzzy hashing algorithm ssdeep to generate fuzzy hash based signature. These signatures were matched to quantify the API call sequence homologies between test samples and training samples.\nThe overall process as following:\n\nCategorization of Win-API CallsThis paper have categorized the total set of 534 Win-API calls into 26 Categories based upon the function these APIs are performing.\n\nFuzzy Hash SignaturesThis paper applied ssdeep program to compute Context Triggered Piecewise Hash (CTPH), also called fuzzy hash, on the categorized API call sequences.\nThe concept of fuzzy hashing has been used as it has the capability to compare two different samples and determine the level of similarity between them. Instead of generating a single hash for a file, piecewise hashing generates many hashes for a file based on different sections of the file. CTPH algorithm uses the rolling hash to determine the start and stop of each segment. CTPH Signature generation algorithm combines these section hashes in a particular way to generate the fuzzy hash of the file.\nThey selected this technique because CTPH can match inputs that have homologies and these sequences may be different in both content and length.\n\nSsdeep matching algorithm calculates the matching between fuzzy hashes of two different samples. This score is based on the edit distance algorithm: Damerau Levenshtein Distance between two strings. After matching a comparison score is generated between 0 and 100. they have used this matching score as malware classification criteria.\nResultFollowing table gives the classification accuracy and FPR for these five 2-class problems.\n\nIn addition, this table gives the accuracy &amp; FPR for 2 class classifier problems (Malware vs Benign).\n\nDeep Learning LSTM based Ransomeware Detection(2017)This paper aims to detect ransomware behavior by employing Long-Short Term Memory (LSTM) networks for binary sequence classification of API calls. They present an automated approach to extract API calls from the log of modified sandbox environment and detect ransomware behavior.\nRansomware are malicious software designed to deny access to a computer system or computer resource. There are two categories of ransomware: Crypto ransomware and locker ransomware. Locker ransomware try to lock access to the system user interface. Crypto ransomware on the other hand, deny access to user ata using strong encryption algorithms.\nAPI call extractionThis paper used a cuckoo-modified since it has provided more anti-anti sandbox features than the standard version. Also, the timeout value for analysis has been extended to 20 minutes to defeat delayed execution strategies employed by some malwares authors.\nThe overall process as following:\n\nLSTMThis paper picked up 38 APIs which were common in all the samples. And then labeled them as an integer between 1 and 39. Each process had a different length of API sequence. After the conversion to integer, 0s were appended to the sequences to match the length of the longest sequence of length 779980.\nFinally, they received an experimental accuracy of 96.67%.\nNEURAL SEQUENTIAL MALWARE DETECTION WITH PARAMETERS(2018)This paper extend previous work, they said the previous LSTM model only considered the API calls sequence but ignored its parameters. So they extend this model to include each system API call’s two most input parameters.\nDue to the variation in the structure and size of the vocabulary, this paper used these parameters in a limited character space. They used these parameters by learning character grams from them. They built n-grams over these characters in the corpus, and only extract the top-K by the frequency distribution.\nThe process of constructing character grams as following:\n\nThen by using the following two algorithms, they converted the n-grams to indexed vector.\n\n\nThen they applied tanh to each vectored parameter, finally concatenate each API calls name with its parameters together.\nThe overall process as following:\n\nThe LSTM process looks like the above paper, which used a maxpooling to extract feature from each stage of LSTM, then applied a logistic regression followed by a ReLU and sigmoid.\nResultThey collected the system API calls and their parameters from 75,000 files, which were evenly split between malware and benign files, in September 2017. The data from all of the files is unique, and there is a total of 158 event types in our data.\nComparison of the ROC curves for two versions of the Events Only LSTM+NN model, the Events Only CNN+LSTM model, and the proposed Events + Parameters model as following:\n\n","dateCreated":"2018-12-18T11:20:01+08:00","dateModified":"2020-05-11T16:34:44+08:00","datePublished":"2018-12-18T11:20:01+08:00","description":"This post summaries 8 papers on dynamic malware detection domain.","headline":"Dynamic Malware Detection Research","image":["https://devblogs.nvidia.com/wp-content/uploads/2017/11/magnifying-glass-locating-malware-in-computer-code-picture-id465994857-625x469.jpg","http://www.e-reveal.com/wp-content/uploads/malware-banner-image.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"http://joddiy.cc/2018/12/18/dynamic-malware-research/"},"publisher":{"@type":"Organization","name":"Joddiy Zhang","sameAs":["https://github.com/joddiy","https://scholar.google.com/citations?user=KH-xv38AAAAJ&hl=en&oi=sra","https://www.linkedin.com/in/joddiyzhang/"],"image":"14108933.jpeg","logo":{"@type":"ImageObject","url":"14108933.jpeg"}},"url":"http://joddiy.cc/2018/12/18/dynamic-malware-research/","keywords":"Malware Detection","thumbnailUrl":"https://devblogs.nvidia.com/wp-content/uploads/2017/11/magnifying-glass-locating-malware-in-computer-code-picture-id465994857-625x469.jpg"}</script>
    <meta name="description" content="This post summaries 8 papers on dynamic malware detection domain.">
<meta property="og:type" content="blog">
<meta property="og:title" content="Dynamic Malware Detection Research">
<meta property="og:url" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/index.html">
<meta property="og:site_name" content="Jz Blog">
<meta property="og:description" content="This post summaries 8 papers on dynamic malware detection domain.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/1.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/2.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/3.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/4.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/5.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/6.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/7.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/8.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/9.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/10.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/11.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/12.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/13.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/14.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/15.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/16.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/18.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/19.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/20.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/21.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/22.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/23.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/17.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/24.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/25.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/26.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/28.png">
<meta property="og:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/29.png">
<meta property="article:published_time" content="2018-12-18T03:20:01.000Z">
<meta property="article:modified_time" content="2020-05-11T08:34:44.000Z">
<meta property="article:author" content="Joddiy Zhang">
<meta property="article:tag" content="Malware Detection">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://joddiy.cc/2018/12/18/dynamic-malware-research/1.png">
    
    
        
    
    
        <meta property="og:image" content="http://joddiy.cc/assets/images/14108933.jpeg"/>
    
    
        <meta property="og:image" content="https://devblogs.nvidia.com/wp-content/uploads/2017/11/magnifying-glass-locating-malware-in-computer-code-picture-id465994857-625x469.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://devblogs.nvidia.com/wp-content/uploads/2017/11/magnifying-glass-locating-malware-in-computer-code-picture-id465994857-625x469.jpg"/>
    
    
        <meta property="og:image" content="http://www.e-reveal.com/wp-content/uploads/malware-banner-image.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://www.e-reveal.com/wp-content/uploads/malware-banner-image.jpg"/>
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-x8blglznjjnb9pnnwui5zw4h43ysufmsh1b0omicawm4vhqcutzqavokgpne.min.css">

    <!--STYLES END-->
    

    

    
        
    
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Jz Blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/14108933.jpeg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/14108933.jpeg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Joddiy Zhang</h4>
                
                    <h5 class="sidebar-profile-bio"><p><a href="mailto:&#106;&#x6f;&#100;&#x64;&#105;&#121;&#x7a;&#x68;&#97;&#110;&#103;&#64;&#x67;&#x6d;&#97;&#105;&#x6c;&#46;&#x63;&#x6f;&#109;">&#106;&#x6f;&#100;&#x64;&#105;&#121;&#x7a;&#x68;&#97;&#110;&#103;&#64;&#x67;&#x6d;&#97;&#105;&#x6c;&#46;&#x63;&#x6f;&#109;</a></p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/joddiy"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://scholar.google.com/citations?user=KH-xv38AAAAJ&hl=en&oi=sra"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Google Scholar"
                        >
                        <i class="sidebar-button-icon fab fa-google" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Google Scholar</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/in/joddiyzhang/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-center
                    post-header-cover--partial"
             style="background-image:url('http://www.e-reveal.com/wp-content/uploads/malware-banner-image.jpg');"
             data-behavior="4">
            
                <div class="post-header main-content-wrap text-center">
    
        <h1 class="post-title">
            Dynamic Malware Detection Research
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2018-12-18T11:20:01+08:00">
	
		    Dec 18, 2018
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Research/">Research</a>


    
</div>

    
</div>

            
        </div>

            <div id="main" data-behavior="4"
                 class="hasCover
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h2 id="Using-Spatio-Temporal-Information-in-API-Calls-with-Machine-Learning-Algorithms-for-Malware-Detection（2009）"><a href="#Using-Spatio-Temporal-Information-in-API-Calls-with-Machine-Learning-Algorithms-for-Malware-Detection（2009）" class="headerlink" title="Using Spatio-Temporal Information in API Calls with Machine Learning Algorithms for Malware Detection（2009）"></a>Using Spatio-Temporal Information in API Calls with Machine Learning Algorithms for Malware Detection（2009）</h2><p>This paper uses statistical features which are extracted from both spatial (arguments) and temporal (sequences) information available in Windows API calls. </p>
<p>The Windows API provides thousands of distinct API calls serving diverse functionalities. However, this paper chooses short-listed 237 API calls which are widely used by both benign Windows applications and malware programs. They refer to the short-listed calls as the core-functionality API calls. They further divide the core-functionality API calls into seven different categories: (1) registry, (2) network management, (3) memory management, (4) file I&#x2F;O, (5) socket, (6) processor and threads, and (7) dynamically linked libraries (DLLs). </p>
<p><img src="/2018/12/18/dynamic-malware-research/1.png" alt="Figure1"></p>
<h3 id="spatial-information"><a href="#spatial-information" class="headerlink" title="spatial information"></a>spatial information</h3><p>The spatial information refers to the set of arguments which always are generally address pointers or variables that hold crisp numerical values. They use fundamental statistical and information theoretic measures to quantify the spatial information. These measures include mean, variance, entropy, minimum, and maximum of given values. For example, they have observed that malware writers suffice on lean and mean implementations of malware programs with low memory usage so that they can remain unnoticed for as long as possible.</p>
<h3 id="Temporal-information"><a href="#Temporal-information" class="headerlink" title="Temporal information"></a>Temporal information</h3><p>Temporal information refers to represents the order of invoked API calls where call sequences and control flow graphs are the most popular techniques. By some auto-correlation analysis, this paper finds that 3rd order dependence has a high correlation for both benign and malware programs, so it finally uses 3-gram API call sequence. Then they model API call sequence using a discrete time Markov chain. The order of a Markov chain represents the extent to which past states determine the present state. They uses 3rd order Markov chain to represent the probability of transitions, which means the next possible API call depends on previous three API calls. The transition matrix T looks like:</p>
<p><img src="/2018/12/18/dynamic-malware-research/2.png" alt="Figure2"></p>
<p>Each element in this matrix indicates the probability of a new API call when they have observed the first 3 API calls. Then the paper information gain to select the most discriminative features:</p>
<p><img src="/2018/12/18/dynamic-malware-research/3.png" alt="Figure3"></p>
<p>Specifically, for each element in the matrix, the paper uses a to count its appearance times in benign training samples and b to count in malware samples. Then this element’s information gain can be computed by:</p>
<p><img src="/2018/12/18/dynamic-malware-research/4.png" alt="Figure4"></p>
<h3 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h3><p>The paper designs an experiment using spatio-temporal features’ set over standalone spatial or temporal features set.  </p>
<p><img src="/2018/12/18/dynamic-malware-research/5.png" alt="Figure5"></p>
<p>The table shows that that spatial and temporal features alone can provide on the average detection accuracies of approximately 0.898 and 0.952 respectively. However, the combined spatio-temporal features’ set provide an average detection accuracy of 0.963 – approximately 5% improvement over standalone features’ set.</p>
<p>NB with spatio-temporal features’ set provides the best detection accuracy of 0.980. It is closely followed by SMO which provides the detection accuracy of 0.968. On the other hand, J48 provides the lowest accuracy of 0.947.</p>
<h2 id="Discovering-Similar-Malware-Samples-Using-API-Call-Topics（2015）"><a href="#Discovering-Similar-Malware-Samples-Using-API-Call-Topics（2015）" class="headerlink" title="Discovering Similar Malware Samples Using API Call Topics（2015）"></a>Discovering Similar Malware Samples Using API Call Topics（2015）</h2><p>This paper aims to extract similar malware samples automatically using the concept of “API call topics,” which represents a set of API calls that are intrinsic to a specific group of malware samples. They present an unsupervised approach to extract API call topics from a large corpus of API calls. Through analysis of the API call logs collected from thousands of malware samples, they demonstrate that the extracted API call topics can detect similar malware samples. The proposed approach is expected to be useful for automating the process of analyzing a huge volume of logs collected from dynamic malware analysis systems.</p>
<p>The key idea of this paper is that they present an unsupervised approach to extract API call topics which can detect similar malware samples. </p>
<h3 id="Dataset"><a href="#Dataset" class="headerlink" title="Dataset"></a>Dataset</h3><p>The data of this paper consists of Cuckoo Sandbox logs of 2,641 malware samples collected from September 2012 to March 2013. The format of all malware samples was the Portable Executable (PE) format used in Windows operating systems. These malware samples were executed on Cuckoo Sandbox in 90 seconds and generated 1.7 GB of dynamic analysis logs in JSON format.</p>
<p>Some interesting they found:</p>
<ul>
<li>The majority of the samples had more than 400 API calls, a few samples had only a small number of API calls.</li>
<li>Malware samples that exhibited a very low number of API calls likely failed to execute correctly because of the anti-VM techniques. Therefore, they pruned malware samples with fewer than 10 API calls.</li>
</ul>
<h3 id="Methodologies"><a href="#Methodologies" class="headerlink" title="Methodologies"></a>Methodologies</h3><h4 id="API-words-features"><a href="#API-words-features" class="headerlink" title="API words features"></a>API words features</h4><p>This paper parsed the JSON formatted Cuckoo Sandbox log, then they used three variables(API function names, arguments names, argument values) to convert an API call into an “API word”， and they omitted return values and thread IDs.</p>
<p>They used level-3 approach to compress the API logs. Its definition is <em>api:n1:v1:n2:v2:…</em>, for example, <em>“LdrGetDllHandle”:”FileName”:”C:nnWINDOWSnnsystem32nnrpcss.dll”:”ModuleHandle”:0x00000000</em>. Using the API words, they generated a feature vector for each malware sample (By BoW approach with TF-IDF word weighting). </p>
<h4 id="Feature-selection"><a href="#Feature-selection" class="headerlink" title="Feature selection"></a>Feature selection</h4><p>The paper applied DF-thresholding to eliminate very popular API words that appear in a majority of the malware samples. These API words are too generic to characterize a cluster of malware samples. </p>
<h4 id="Non-negative-Matrix-Factorization-NMF"><a href="#Non-negative-Matrix-Factorization-NMF" class="headerlink" title="Non-negative Matrix Factorization (NMF)"></a>Non-negative Matrix Factorization (NMF)</h4><p>NMF is an algorithm that factorizes a matrix into two matrices with the constraint that all three matrices have no negative elements. The advantage of NMF is that it can extract topics that can then be used as signatures for the task. </p>
<p>The key idea of NMF is to factorize the feature matrix X, i.e., X &#x3D; TV.</p>
<p><img src="/2018/12/18/dynamic-malware-research/6.png" alt="Figure6"></p>
<p>K is a parameter that controls the number of basis, which corresponds to clusters. The matrices T and V can be interpreted as the topic (basis) and the clustering results, respectively. This factorization can be obtained by minimizing the distance between the matrices X and TV: </p>
<p><img src="/2018/12/18/dynamic-malware-research/7.png" alt="Figure7"></p>
<p>The paper adopt Kullback-Leibler(KL) divergence to compute the distance d:</p>
<p><img src="/2018/12/18/dynamic-malware-research/8.png" alt="Figure8"></p>
<h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><p>The API call topics successfully extracted malware samples that had the similar intrinsic API calls. In addition, the detected malware samples were actually similar to each other because the majority of the detected samples have a single primary label in each cluster.</p>
<p><img src="/2018/12/18/dynamic-malware-research/9.png" alt="Figure9"></p>
<h2 id="DeepSign-Deep-Learning-for-Automatic-Malware-Signature-Generation-and-Classification（2015）"><a href="#DeepSign-Deep-Learning-for-Automatic-Malware-Signature-Generation-and-Classification（2015）" class="headerlink" title="DeepSign: Deep Learning for Automatic Malware Signature Generation and Classification（2015）"></a>DeepSign: Deep Learning for Automatic Malware Signature Generation and Classification（2015）</h2><p>The method uses a deep belief network (DBN), implemented with a deep stack of denoising autoencoders, generating an invariant compact representation of the malware behavior.</p>
<h3 id="Feature"><a href="#Feature" class="headerlink" title="Feature"></a>Feature</h3><p>This paper used one of the simplest method of NLP to approach the sandbox files, that is, using unigram(1-gram) extraction. Furthermore, this paper in order to remain as domain agnostic as possible, they propose to treat the sandbox file as a simple text file, and extract unigrams without any preprocessing. That means, they omits all meaningless symbols and only pay attention to the words, for example, given “api”: “CreateFileW”, the terms extracted are “api”: and “CreateFileW”, completely ignoring what each part means. </p>
<p>In order to get the fixed size features, they proposed that:</p>
<ol>
<li>For each sandbox file in the dataset, extract all unigrams.</li>
<li>Remove the unigrams which appear in all files (contain no information).</li>
<li>For each unigram count the number of files in which it appears.</li>
<li>Select top 20,000 with highest frequency.</li>
<li>Convert each sandbox file to a 20,000 sized bit string, by checking whether each of the 20,000 unigrams appeared in it.</li>
</ol>
<p>In their approach, they trained a deep denoising autoencoder consisting of eight layer: 20,000–5,000–2,500–1,000–500–250–100–30. At each step only one layer is trained, then the weights are “frozen”, and the subsequent layer is trained. </p>
<p>At the end of this training phase, they have a deep network which is capable of converting the 20,000 input vector into 30 floating point values. They regard these 30-sized vector as the “signature” of the program.</p>
<p>The process of DBN training looks like:</p>
<p><img src="/2018/12/18/dynamic-malware-research/10.png" alt="Figure10"></p>
<p>(I) Train the first autoencoder layer. (II) Use the weights from the previous layer, and build a new autoencoder on top of them. The weights taken from the first autoencoder are frozen. (III) Similarly, take the weights from the previous layer and add a new layer. (IV) Proceed with layer-wise training until training all the eight layers for the final DBN.</p>
<p>The all steps of this paper:</p>
<p><img src="/2018/12/18/dynamic-malware-research/11.png" alt="Figure11"></p>
<p>Some configuration:</p>
<ul>
<li>Each layer-wise training with a 0.5 dropout.</li>
<li>Using ReLU as the activation function.</li>
<li>0.2 noise ratio, 0.001 learning rate then linearly decays to 0.000001, batch size of 20, and no momentum.</li>
</ul>
<h3 id="Dataset-1"><a href="#Dataset-1" class="headerlink" title="Dataset"></a>Dataset</h3><p>Their dataset consists of six major categories of malware, and 300 variants in each category, for a total of 1,800 samples. The six malware categories used are Zeus, Carberp, Spy-Eye, Cidox, Andromeda, and DarkComet.</p>
<h3 id="Experimental-Results"><a href="#Experimental-Results" class="headerlink" title="Experimental Results"></a>Experimental Results</h3><ul>
<li>SVM with 96.4% accuracy.</li>
<li>KNN with 95.3% accuracy.</li>
<li>This paper’s DBN with 98.6% accuracy.</li>
</ul>
<h2 id="A-Novel-Approach-to-Detect-Malware-Based-on-API-Call-Sequence-Analysis（2015"><a href="#A-Novel-Approach-to-Detect-Malware-Based-on-API-Call-Sequence-Analysis（2015" class="headerlink" title="A Novel Approach to Detect Malware Based on API Call Sequence Analysis（2015)"></a>A Novel Approach to Detect Malware Based on API Call Sequence Analysis（2015)</h2><p>This paper adopted DNA sequence alignment algorithms and extracted common API call sequence patterns of malicious function from malware in different categories. They indicated that two major approaches in dynamic analysis are control flow analysis and API call analysis. However, malware authors try to circumvent those techniques through inserting meaningless codes or shuffling the sequence of programs.</p>
<h3 id="DNA-Sequence-Alignment"><a href="#DNA-Sequence-Alignment" class="headerlink" title="DNA Sequence Alignment"></a>DNA Sequence Alignment</h3><p>Sequence alignment algorithms are most widely used in the area of biometrics to calculate the similarity between two or more DNA sequences or to find certain DNA subsequences from full DNA.</p>
<p>Sequence alignment algorithms fall into two categories, which are global and local alignment. Global alignment aligns entire sequence. It is useful when they attempt to find the sequence of most similar length and strings. Local alignment finds the highly similar subsequences between given sequences. </p>
<p>Pairwise sequence alignment methods find global alignments or the locally similar subsequences of two sequences. Multiple sequence alignment algorithm extends pairwise alignment to handle multiple sequences at the same time. This paper applied multiple sequence alignment algorithm.</p>
<h3 id="Environment-Setup"><a href="#Environment-Setup" class="headerlink" title="Environment Setup"></a>Environment Setup</h3><p>In this study, they used the Detours hooking library supported byMicrosoft to trace API call sequences from Windows executable programs. The Detours hooking process proceeds as shown in the following. Unlike the original process without Detours, the hooking process goes through the Detour function and the Trampoline function. This allows them to trace API call sequence.</p>
<p><img src="/2018/12/18/dynamic-malware-research/12.png" alt="Figure12"></p>
<p>For DNA sequence alignment, they used the ClustalX. ClustalX is widely used freeware in genome sequence analysis, such as DNA, RNA, or protein sequences. The program supports multiple sequence alignment (MSA) and also provides visualization.</p>
<p>In their dataset, 2,727 kinds of API were found; they categorized them into 26 groups according to MSDN library:<br>In our dataset, 2,727 kinds of API were found; they categorized them into 26 groups according to MSDN library:</p>
<p><img src="/2018/12/18/dynamic-malware-research/13.png" alt="Figure13"></p>
<p>To extract the common API call sequence pattern among malware, the longest common subsequences (LCSs) were used. LCS shows the longest malware API call sequence pattern, it can be treated as a malware’s signature. For example, the LCSs of ABCD and ACB are AB and AC:</p>
<p>Furthermore, they excluded these typical LCSs reduce false positive error since some benign programs share same API calls sequence. They employed an additional feature. They assumed that there exists a specific API call sequence pattern that matches specific malicious activity. If such an API call sequence pattern exists, they can detect unknown attacks by checking whether a critical API call sequence pattern exists. For example:</p>
<p><img src="/2018/12/18/dynamic-malware-research/14.png" alt="Figure14"></p>
<p>It should be noted that round brackets represent the OR relation. For example, in the case of IAT hooking, one possible critical API call sequence pattern is [LoadLibrary, strcmp, VirtualProtect]. They believe that this behavior-based malware classification can be effective in the dynamic analysis of API call sequences.</p>
<p>The overall process as following:</p>
<p><img src="/2018/12/18/dynamic-malware-research/15.png" alt="Figure15"></p>
<p>In the analysis process, the extracted API call sequence of a newly inserted program is compared with the API signatures in the database. If any LCS ismatched with the signatures, the newly inserted program is classified as malware.</p>
<h3 id="Experiment-result"><a href="#Experiment-result" class="headerlink" title="Experiment result"></a>Experiment result</h3><p>To summarize, the precision is 1, FPR is 0, and recall is 0.998. The 𝐹1 score is 0.999.</p>
<p><img src="/2018/12/18/dynamic-malware-research/16.png" alt="Figure16"></p>
<h2 id="MALWARE-CLASSIFICATION-WITH-RECURRENT-NETWORKS-2015"><a href="#MALWARE-CLASSIFICATION-WITH-RECURRENT-NETWORKS-2015" class="headerlink" title="MALWARE CLASSIFICATION WITH RECURRENT NETWORKS(2015)"></a>MALWARE CLASSIFICATION WITH RECURRENT NETWORKS(2015)</h2><p>This paper proposed a different approach, which, similar to natural language modeling, learns the language of malware spoken through the executed instructions and extracts robust, time domain features. Echo state networks (ESNs) and recurrent neural networks (RNNs) are used for the projection stage that extracts the features.</p>
<p>Specifically, using the recurrent model to directly classify the files is not efficient (there is only a single bit of information for every sequence). Instead, they use a recurrent model trained to predict next API call, and use the hidden state of the model (that encodes the history of past events) as the fixed-length feature vector that is given to a separate classifier (logistic regression or MLP).</p>
<p>The overall process as following:</p>
<p><img src="/2018/12/18/dynamic-malware-research/18.png" alt="Figure18"></p>
<p>ut and ht demote the input and state vectors. At each state, they apply a recurrent neural network operation to the input and get a hidden vector ht. Then they apply a max-pooling to get a feature vector, then, applying a MLP or logistic regression to do the classification on the feature vector</p>
<p>Finally, they got TPR 71.71% at FPR 0.1%.</p>
<h2 id="Malware-Characterization-using-Windows-API-Call-Sequences-2016"><a href="#Malware-Characterization-using-Windows-API-Call-Sequences-2016" class="headerlink" title="Malware Characterization using Windows API Call Sequences(2016)"></a>Malware Characterization using Windows API Call Sequences(2016)</h2><p>This paper proposed a hashed method to identify the category of malware. First, they chose a total set of 534 important Win-APIs have been hooked and mapped to 26categories (A…Z). Then they used Fuzzy hashing algorithm ssdeep to generate fuzzy hash based signature. These signatures were matched to quantify the API call sequence homologies between test samples and training samples.</p>
<p>The overall process as following:</p>
<p><img src="/2018/12/18/dynamic-malware-research/19.png" alt="Figure19"></p>
<h3 id="Categorization-of-Win-API-Calls"><a href="#Categorization-of-Win-API-Calls" class="headerlink" title="Categorization of Win-API Calls"></a>Categorization of Win-API Calls</h3><p>This paper have categorized the total set of 534 Win-API calls into 26 Categories based upon the function these APIs are performing.</p>
<p><img src="/2018/12/18/dynamic-malware-research/20.png" alt="Figure20"></p>
<h3 id="Fuzzy-Hash-Signatures"><a href="#Fuzzy-Hash-Signatures" class="headerlink" title="Fuzzy Hash Signatures"></a>Fuzzy Hash Signatures</h3><p>This paper applied ssdeep program to compute Context Triggered Piecewise Hash (CTPH), also called fuzzy hash, on the categorized API call sequences.</p>
<p>The concept of fuzzy hashing has been used as it has the capability to compare two different samples and determine the level of similarity between them. Instead of generating a single hash for a file, piecewise hashing generates many hashes for a file based on different sections of the file. CTPH algorithm uses the rolling hash to determine the start and stop of each segment. CTPH Signature generation algorithm combines these section hashes in a particular way to generate the fuzzy hash of the file.</p>
<p>They selected this technique because CTPH can match inputs that have homologies and these sequences may be different in both content and length.</p>
<p><img src="/2018/12/18/dynamic-malware-research/21.png" alt="Figure21"></p>
<p>Ssdeep matching algorithm calculates the matching between fuzzy hashes of two different samples. This score is based on the edit distance algorithm: Damerau Levenshtein Distance between two strings. After matching a comparison score is generated between 0 and 100. they have used this matching score as malware classification criteria.</p>
<h3 id="Result-1"><a href="#Result-1" class="headerlink" title="Result"></a>Result</h3><p>Following table gives the classification accuracy and FPR for these five 2-class problems.</p>
<p><img src="/2018/12/18/dynamic-malware-research/22.png" alt="Figure22"></p>
<p>In addition, this table gives the accuracy &amp; FPR for 2 class classifier problems (Malware vs Benign).</p>
<p><img src="/2018/12/18/dynamic-malware-research/23.png" alt="Figure23"></p>
<h2 id="Deep-Learning-LSTM-based-Ransomeware-Detection-2017"><a href="#Deep-Learning-LSTM-based-Ransomeware-Detection-2017" class="headerlink" title="Deep Learning LSTM based Ransomeware Detection(2017)"></a>Deep Learning LSTM based Ransomeware Detection(2017)</h2><p>This paper aims to detect ransomware behavior by employing Long-Short Term Memory (LSTM) networks for binary sequence classification of API calls. They present an automated approach to extract API calls from the log of modified sandbox environment and detect ransomware behavior.</p>
<p>Ransomware are malicious software designed to deny access to a computer system or computer resource. There are two categories of ransomware: Crypto ransomware and locker ransomware. Locker ransomware try to lock access to the system user interface. Crypto ransomware on the other hand, deny access to user ata using strong encryption algorithms.</p>
<h3 id="API-call-extraction"><a href="#API-call-extraction" class="headerlink" title="API call extraction"></a>API call extraction</h3><p>This paper used a cuckoo-modified since it has provided more anti-anti sandbox features than the standard version. Also, the timeout value for analysis has been extended to 20 minutes to defeat delayed execution strategies employed by some malwares authors.</p>
<p>The overall process as following:</p>
<p><img src="/2018/12/18/dynamic-malware-research/17.png" alt="Figure17"></p>
<h3 id="LSTM"><a href="#LSTM" class="headerlink" title="LSTM"></a>LSTM</h3><p>This paper picked up 38 APIs which were common in all the samples. And then labeled them as an integer between 1 and 39. Each process had a different length of API sequence. After the conversion to integer, 0s were appended to the sequences to match the length of the longest sequence of length 779980.</p>
<p>Finally, they received an experimental accuracy of 96.67%.</p>
<h2 id="NEURAL-SEQUENTIAL-MALWARE-DETECTION-WITH-PARAMETERS-2018"><a href="#NEURAL-SEQUENTIAL-MALWARE-DETECTION-WITH-PARAMETERS-2018" class="headerlink" title="NEURAL SEQUENTIAL MALWARE DETECTION WITH PARAMETERS(2018)"></a>NEURAL SEQUENTIAL MALWARE DETECTION WITH PARAMETERS(2018)</h2><p>This paper extend previous work, they said the previous LSTM model only considered the API calls sequence but ignored its parameters. So they extend this model to include each system API call’s two most input parameters.</p>
<p>Due to the variation in the structure and size of the vocabulary, this paper used these parameters in a limited character space. They used these parameters by learning character grams from them. They built n-grams over these characters in the corpus, and only extract the top-K by the frequency distribution.</p>
<p>The process of constructing character grams as following:</p>
<p><img src="/2018/12/18/dynamic-malware-research/24.png" alt="Figure24"></p>
<p>Then by using the following two algorithms, they converted the n-grams to indexed vector.</p>
<p><img src="/2018/12/18/dynamic-malware-research/25.png" alt="Figure25"></p>
<p><img src="/2018/12/18/dynamic-malware-research/26.png" alt="Figure26"></p>
<p>Then they applied tanh to each vectored parameter, finally concatenate each API calls name with its parameters together.</p>
<p>The overall process as following:</p>
<p><img src="/2018/12/18/dynamic-malware-research/28.png" alt="Figure28"></p>
<p>The LSTM process looks like the above paper, which used a maxpooling to extract feature from each stage of LSTM, then applied a logistic regression followed by a ReLU and sigmoid.</p>
<h3 id="Result-2"><a href="#Result-2" class="headerlink" title="Result"></a>Result</h3><p>They collected the system API calls and their parameters from 75,000 files, which were evenly split between malware and benign files, in September 2017. The data from all of the files is unique, and there is a total of 158 event types in our data.</p>
<p>Comparison of the ROC curves for two versions of the Events Only LSTM+NN model, the Events Only CNN+LSTM model, and the proposed Events + Parameters model as following:</p>
<p><img src="/2018/12/18/dynamic-malware-research/29.png" alt="Figure29"></p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Malware-Detection/" rel="tag">Malware Detection</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/05/01/Packed-Neural-Network-Training/"
                    data-tooltip="Understanding and Optimizing Packed Neural Network Training for Hyper-Parameter Tuning"
                    aria-label="PREVIOUS: Understanding and Optimizing Packed Neural Network Training for Hyper-Parameter Tuning"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2017/10/13/%E5%88%A9%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96SQL/"
                    data-tooltip="利用子查询优化SQL"
                    aria-label="NEXT: 利用子查询优化SQL"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2024 Joddiy Zhang. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/05/01/Packed-Neural-Network-Training/"
                    data-tooltip="Understanding and Optimizing Packed Neural Network Training for Hyper-Parameter Tuning"
                    aria-label="PREVIOUS: Understanding and Optimizing Packed Neural Network Training for Hyper-Parameter Tuning"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2017/10/13/%E5%88%A9%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96SQL/"
                    data-tooltip="利用子查询优化SQL"
                    aria-label="NEXT: 利用子查询优化SQL"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=http://joddiy.cc/2018/12/18/dynamic-malware-research/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/14108933.jpeg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Joddiy Zhang</h4>
        
            <div id="about-card-bio"><p><a href="mailto:&#x6a;&#111;&#100;&#x64;&#x69;&#121;&#x7a;&#104;&#97;&#x6e;&#x67;&#64;&#x67;&#109;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;">&#x6a;&#111;&#100;&#x64;&#x69;&#121;&#x7a;&#104;&#97;&#x6e;&#x67;&#64;&#x67;&#109;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;</a></p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Machine Learning Engineer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Singapore
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-sqrh47zm5nkjgifq4rx38uvns4r2rarrrvwuhjxiztyrddruca5ukl7nw6br.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
